<Window x:Class="ActormixerSanitizer.UI.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Actormixer Sanitizer" Height="450" Width="800"
        ThemeMode="System">
    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="100"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
            <Button Content="Connect" Command="{Binding ConnectCommand}" 
                    Width="100" Margin="0,0,10,0"/>
            <Button Content="Scan" Command="{Binding ScanCommand}"
                    Width="100" Margin="0,0,10,0"/>
            <Button Content="Select All" Command="{Binding SelectAllCommand}"
                    Width="100" Margin="0,0,10,0"/>
            <Button Content="Select None" Command="{Binding SelectNoneCommand}"
                    Width="100" Margin="0,0,10,0"/>
            <Button Content="Toggle Selected" Command="{Binding ToggleSelectedCommand}"
                    CommandParameter="{Binding ElementName=ActorMixerListBox, Path=SelectedItems}"
                    Width="100" Margin="0,0,10,0"/>
        </StackPanel>

        <!-- Replaced DataGrid with ListBox using solution 2: bind ListBoxItem.IsSelected to item.IsSelected -->
        <ListBox Grid.Row="1"
                 Name="ActorMixerListBox"
                 ItemsSource="{Binding ActorMixers}"
                 SelectionMode="Extended"
                 HorizontalContentAlignment="Stretch"
                 BorderThickness="0">
            <ListBox.ItemContainerStyle>
                <Style TargetType="ListBoxItem">
                    <!-- Keep ListBox selection and the item's IsSelected property synchronized
                    <Setter Property="IsSelected" Value="{Binding IsSelected, Mode=TwoWay}"/> -->
                    <!-- TODO2: Doubliclick to toggle checkmark -->
                    <!-- TODO3: ~~Context menu for copying name, id, path~~ and selecting in Wwise -->
                    <!-- TODO4: Save to Wwise Querry Button -->
                    <!-- TODO5: Improve connection flow, logging and error handling -->
                    <!-- TODO6: Adjustable logging window size -->
                    <!-- TODO7: Icons and shipit -->
                    <!-- TODO7: White sapce in Watch copy logs-->
                    <Setter Property="Tag" Value="{Binding DataContext, ElementName=ActorMixerListBox}"/>
                    <Setter Property="ContextMenu">
                        <Setter.Value>
                            <ContextMenu>
                                <MenuItem Header="{Binding Name}" IsEnabled="False"/>
                                <Separator/>
                                <MenuItem Header="Copy name" Command="{Binding PlacementTarget.Tag.CopyNameCommand, RelativeSource={RelativeSource AncestorType=ContextMenu}}" CommandParameter="{Binding}"/>
                                <MenuItem Header="Copy id" Command="{Binding PlacementTarget.Tag.CopyIdCommand, RelativeSource={RelativeSource AncestorType=ContextMenu}}" CommandParameter="{Binding}"/>
                                <MenuItem Header="Copy path" Command="{Binding PlacementTarget.Tag.CopyPathCommand, RelativeSource={RelativeSource AncestorType=ContextMenu}}" CommandParameter="{Binding}"/>
                                <MenuItem Header="Select in Wwise"/>
                            </ContextMenu>
                        </Setter.Value>
                    </Setter>
                </Style>
            </ListBox.ItemContainerStyle>

            <ListBox.ItemTemplate>
                <DataTemplate>
                    <Border Padding="2" Margin="2" BorderBrush="LightGray" BorderThickness="0,0,0,0">
                        <DockPanel>
                            <CheckBox DockPanel.Dock="Left"
                                      VerticalAlignment="Center"
                                      IsChecked="{Binding IsSelected, Mode=TwoWay}"
                                      Margin="0,0,2,0"/>
                            <StackPanel>
                                <TextBlock Text="{Binding Name}" FontWeight="SemiBold"/>
                                <TextBlock Text="{Binding Path}" FontSize="12" Foreground="Gray"/>
                            </StackPanel>
                        </DockPanel>
                    </Border>
                </DataTemplate>
            </ListBox.ItemTemplate>

        </ListBox>

        <TextBox Grid.Row="2" Text="{Binding LogText, Mode=OneWay}"
                 IsReadOnly="True" TextWrapping="Wrap"
                 VerticalScrollBarVisibility="Auto"/>

        <Button Grid.Row="3" Content="Convert Selected to Folders" 
                Command="{Binding ConvertCommand}"
                Height="30" Margin="0,10,0,0"/>
    </Grid>
</Window>